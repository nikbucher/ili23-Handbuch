[#_2_2]
=== Premiers pas

[#_2_2_1]
==== L'Association nationale des offices de tourisme a défriché le terrain

Avec son logiciel NatTourSys, l'Association nationale des offices de tourisme propose une large vue d'ensemble des différents billets vendus pour les remontées mécaniques. Les billets sont délivrés par les différentes sociétés exploitantes. Ce qui intéresse prioritairement les touristes, c'est toutefois de savoir quels billets sont valables sur quelles remontées mécaniques. Ainsi, les Ilinois souhaitent-ils d'abord se faire une idée de ce qui existe avant de se lancer dans leur propre projet.

Une chose est claire : il faut définir avec précision ce que recouvrent les notions de remontée mécanique (ou de ligne de montagne), de société de remontées mécaniques et de billets dans le contexte du logiciel.

A quoi fait-on réellement référence lorsque l'on parle de billet ? Au ticket vendu à l‘unité à l'usager ? Dans cette application-là, certainement pas. On souhaiterait plutôt décrire les différents types de billets, raison pour laquelle nous introduisons dès maintenant la notion de « type de billet ». Les différents objets possèdent des propriétés dont la portée dépasse manifestement leur cadre. Ainsi en va-t-il du prix ou de la durée de validité dans le cas des types de billets.

* *Remontée mécanique (ou ligne de montagne)* – Une remontée mécanique (ou ligne de montagne, on utilisera indifféremment l'une ou l'autre expression dans la suite) transporte des passagers entre une station inférieure et une station supérieure. Le funiculaire Ili-village – Dent d'Ili en constitue un exemple, mais il existe aussi des chemins de fer à crémaillère, des téléphériques, des télécabines, des remonte-pentes et des télésièges. Et le tout nouveau « bus des neiges » peut également être considéré comme faisant partie de cette catégorie. Chaque type de remontée possède un nom bien spécifique.
* *Type de billet* – Il désigne un type de billet bien défini. Exemples : le forfait pour les sportifs à 195 couronnes, valable sept jours durant sur l'ensemble des remontées du Val d'Ili ou encore le forfait « Dino » à 10 couronnes, valable le jour de son émission sur le tire-fesses.
* *Société de remontées mécaniques* – Une telle société exploite des remontées mécaniques. Un nom et parfois un nom abrégé lui sont associés. Les Remontées mécaniques de la Dent d'Ili (RDI en abrégé) en sont un exemple. Toute société de remontées mécaniques perçoit une partie du produit de la vente des billets valables sur son réseau. Une société de remontées mécaniques peut être la filiale ou la société mère d'une autre entreprise de transport en montagne.

[NOTE]
Le *catalogue des objets* d'une application répertorie l'ensemble des éléments d'importance pour elle et les décrit avec des mots aussi précis que possible.

Si l'on décrit cependant toutes les propriétés des éléments par du texte, il devient rapidement difficile d'en conserver une vue d'ensemble. Et comme une image est toujours plus évocatrice qu'un long discours, la solution consiste à représenter les objets sous forme d'un diagramme ! Mais la description détaillée de tous les objets nous intéresse-t-elle vraiment ? Certes, mais ce qui nous intéresse surtout, c'est de répertorier les éléments identiques et les propriétés qu'ils possèdent.

Un tel diagramme permet de saisir l'essentiel d'un coup d'oeil :

.La première ébauche d'un modèle de données
image::img/image3.png[]


[NOTE]
====
La remontée mécanique, le type de billet et la société de remontées mécaniques sont des *classes d'objets* (cases). Entre elles existent des *relations* (traits de liaison). L'ensemble des définitions concernant les classes et les relations qui les unissent constitue le *modèle de données*. La représentation figurative s'opère à l'aide de *diagrammes de classes*.

_Notions apparentées aux classes d'objets : ensemble d'entités, table, type, ..._

_Notions apparentées aux relations : association, renvoi, connexion, indicateur (réciproque), ..._

_Notions apparentées au modèle de données : schéma (conceptuel), description de données, ..._
====

Les classes d'objets sont désignées au moyen de substantifs (isolés ou composés). On utilise le singulier pour exprimer le fait que chaque objet (chaque remontée mécanique par exemple) possède les propriétés décrites par cette classe.

[NOTE]
====
Toute remontée mécanique, toute société exploitante et tout type de billet est décrit par l'intermédiaire d'un *objet* concret. Les objets sont les *données* dont la structure et les interactions sont décrites par le modèle.

_Notions apparentées aux objets : exemplaire, instance, empreinte, jeu de données, ligne, uplet, entrée, ..._
====

Toute remontée mécanique est exploitée par une société, laquelle propose un certain nombre de types de billets. On suppose que ces derniers sont valables sur l'ensemble des lignes de l'entreprise, en l'absence de toute information supplémentaire. Mais on ne peut pas se satisfaire de cette hypothèse dans la mesure où les sociétés d'une certaine taille émettent des types de billets uniquement valables sur une partie de leur réseau. La première idée venant à l'esprit consiste à introduire une relation supplémentaire entre la remontée mécanique et le type de billet. On doit donc indiquer, pour chacun des types de billets, les lignes sur lesquelles il est valable :

.Le modèle de données a été étendu par une relation entre la remontée mécanique et le type de billet.
image::img/image6.png[]


Il est cependant fréquent que plusieurs types de billets (exemple : forfait à la journée, hebdomadaire, etc.) soient valables dans une même zone. Le modèle tel qu'il est formulé pour l'instant imposerait de générer les affectations séparément pour chaque type de billet ce qui serait non seulement fastidieux mais également porteur de risques d'erreurs importants. C'est pourquoi l'Association nationale des offices de tourisme a choisi de recourir à un modèle un peu plus élaboré :

.Modèle de données révisé. Aucune signification particulière n'est attachée au coude dans le trait de liaison entre la société de remontées mécaniques et le type de billet.
image::img/image7.png[]


[WARNING]
Une réflexion préalable sur les classes d'objets requises par le problème posé et sur les relations qu'elles entretiennent les unes avec les autres se révèle particulièrement judicieuse. Les propriétés des objets nous préoccupent encore peu à ce stade où il est plus important de rechercher des notions ou des désignations adaptées.

[#_2_2_2]
==== Combien de lignes une société de remontés mécaniques exploite-t-elle ?

Plusieurs remontées mécaniques peuvent être affectées à une même société. Inversement, une société donnée peut se voir affecter plusieurs remontées mécaniques. Plusieurs ? Mais combien exactement ?

[NOTE]
La *cardinalité* fixe le nombre d'objets d'un autre type pouvant être affectés à un objet d'un type donné.

Sur la représentation graphique, les valeurs admissibles (minimum et maximum) du nombre d'autres objets sont indiquées aux extrémités des traits de relation, à proximité des cases de classes. Si aucune limite supérieure n'est fixée à cette valeur, l'indication d'un astérisque (++*++) ou l'absence de toute valeur le signale.

.Une remontée mécanique est exploitée par une (1) société. Inversement, une société peut exploiter un nombre quelconque (++*++) de remontées mécaniques.
image::img/image9.png[]


[#_2_2_3]
==== Les remontées mécaniques, les sociétés exploitantes et les abonnements possèdent des propriétés

Il est bien évident que l'application prévue requiert de décrire plus en détail ce qu'est une remontée mécanique, une société de remontées mécaniques, etc. Un nom et généralement un nom abrégé (exemple : les Remontées mécaniques de la Dent d'Ili ou RDI) sont associés à une société de remontées mécaniques.

.La classe d'objets de la société de remontées mécaniques avec le nom et le nom abrégé qui lui sont associés.
image::img/image10.png[]


[NOTE]
====
Le nom et le nom abrégé désignent des *attributs* de la classe d'objets de société de remontées mécaniques. 

_Notions apparentées aux attributs : colonne, champ, propriété, ..._
====

La désignation de nos deux attributs laisse assez clairement apparaître le type dont il s'agit : du texte. Dans le cas du prix d'un type de billet, l'indication d'informations supplémentaires est déjà un peu plus importante : franc, euro, dollar, couronne béotienne ? Le cas de la durée de validité devient plus épineux encore, surtout s'il n'est pas possible de la décrire par un nombre de jours. Et si l'on souhaite indiquer la longueur d'une ligne, il va de soi qu'il faut préciser l'unité dans laquelle cette valeur est exprimée, en mètres ou en kilomètres. Il est important que les programmes de traitement aient connaissance de la longueur prévue pour les attributs textuels ou des limites dans lesquelles les valeurs permises peuvent évoluer.

[NOTE]
====
Le *type* d'un attribut décrit les valeurs que ce dernier peut prendre et la signification qui leur est attachée.

_Le domaine de valeurs est une notion apparentée au type._
====

.La classe d'objets de « société de remontées mécaniques » possède un nom et un nom abrégé.
[%autowidth]
|===
2+|Classe d'objets SocieteRemonteesMecaniques

|Nom :
|Texte +
 _Longueur : Cent caractères au plus_
|NomAbrege :
|Texte +
 _Longueur : Dix caractères au plus_
|===

Le type de la propriété du « nom » est un texte comportant au plus cent caractères. Dix caractères au plus sont en revanche admis pour la propriété du « nom abrégé ».

Bien d'autres types d'attributs sont également envisageables :

.La classe d'objets du type de billet avec ses propriétés et leurs types.
[%autowidth]
|===
2+|Classe d'objets TypeBillet

|Nom :
|Texte +
 _Longueur : Cent caractères au plus_
|Prix :
|Valeur numérique +
 _Précision : Deux chiffres après la virgule_ +
 _Plage admissible : Entre 0 et 5000_ +
 _Unité : Couronne béotienne_
|===

Contrairement à un type de billet ou à une société de remontées mécaniques, la station inférieure d'une remontée mécanique est un objet doté d'une existence réelle en un lieu bien précis. Il est judicieux de décrire une position au moyen de coordonnées exprimées dans un système de coordonnées clairement défini tel que le système national.

.La classe d'objets de remontée mécanique avec ses propriétés et leurs types.
[%autowidth]
|===
2+|Classe d'objets RemonteeMecanique

|Nom :
|Texte +
 _Longueur : Cent caractères au plus_
|Position de la station inférieure :
|Point +
 _Système de coordonnées : Coordonnées nationales béotiennes_
|Position de la station supérieure :
|Point +
 _Système de coordonnées : Coordonnées nationales béotiennes_
|===

Un type d'attribut adéquat est ainsi défini pour chacune des propriétés. Dans le cas d'une piste de ski, le niveau de difficulté constitue une énumération. Le tracé de la piste est en revanche une ligne orientée dont les sommets sont exprimés en coordonnées nationales béotiennes. Les différents types seront abordés plus avant au <<_6>>.

.La classe d'objets de piste de ski avec ses propriétés et leurs types.
[%autowidth]
|===
2+|Classe d'objets PisteSki

|Tracé :
|Ligne orientée +
 _Système de coordonnées : Coordonnées nationales béotiennes_
|Niveau de difficulté :
|Enumération +
 _Valeurs possibles : bleu, rouge, noir_
|===

[#_2_2_4]
==== Des modèles ? Le Val d'Ili veut des données !

Après tous ces développements plutôt théoriques, les Ilinois réclament des faits. La demande déposée auprès de l'Association nationale des offices de tourisme a abouti à la mise à disposition par cette dernière d'un logiciel de saisie de données simple et conforme à ses exigences. Ce logiciel permet d'exporter les données au format INTERLIS après quoi elles sont transmises à l'Association nationale des offices de tourisme. L'informaticien a beau objecter que cela permettra tout au plus d'effectuer un premier test et que la gestion effective des données devra ensuite s'effectuer à l'aide du logiciel des Remontées mécaniques de la Dent d'Ili ou de celui du service des constructions, mais rien n'y fait. Les Ilinois tiennent à l'effectuer, ce test. Il ne devrait d'ailleurs pas nécessiter une débauche d'énergie exagérée. Après tout, les Remontées mécaniques de la Dent d'Ili ne sont pas si étendues et le nombre de types de billets différents est relativement réduit.

[WARNING]
Agir ainsi dans l'urgence ne peut se justifier que si le volume de travail concerné reste limité.

Les Remontées mécaniques de la Dent d'Ili regroupent les lignes suivantes :

* Funiculaire Ili-village – Dent d'Ili ;
* Télécabine Ili-les-Bains – Crête d'Ili ;
* Remonte-pente Crête d'Ili – Dent d'Ili ;
* Télésiège Vallon d'Ili – Crête d'Ili ;
* Tire-fesses à Ili-village et Ili-les-Bains.

.Le réseau de lignes exploité par les Remontées mécaniques de la Dent d'Ili.
image::img/image11.png[]


Les Remontées mécaniques de la Dent d'Ili émettent les billets des types suivants :

* Billets à l'unité pour le funiculaire (prix d'un aller simple : 10 couronnes ; d'un aller-retour : 18 couronnes) ;
* Billets à l'unité pour la télécabine (prix d'un aller simple : 8 couronnes ; d'un aller-retour : 14 couronnes) ;
* Forfait du randonneur pour le funiculaire et la télécabine (prix pour une journée : 15 couronnes ; pour sept jours : 55 couronnes) ;
* Forfait du sportif sur toutes les remontées (prix pour une journée : 40 couronnes, pour deux journées : 70 couronnes, pour sept jours : 195 couronnes, pour toute une année : 635 couronnes) ;
* Le forfait à la journée « Dino » (10 couronnes) et le forfait hebdomadaire « Ilosaurus Maximus » (45 couronnes) pour les tire-fesses.

[#_2_2_5]
==== Le Val d'Ili transmet

Un fichier contenant toutes les données requises a pu être créé pour les besoins du test.

____
[NOTE]
Le genre de transfert le plus simple est le *transfert intégral*, lors duquel toutes les données sont transmises.
____

Un bref coup d'oeil au fichier a permis de constater qu'au milieu d'un océan de signes cabalistiques plus ou moins étranges surnageaient quelques expressions connues comme les « Remontées mécaniques de la Dent d'Ili » ou le nom abrégé « RDI », voire quelques valeurs familières comme le prix de l'abonnement.

Nouveau test : le prix du forfait sportif annuel est ramené de 635 à 600 couronnes et un nouveau fichier est généré à l'aide de la fonction de livraison complémentaire. Si le début reste identique, on cherche en vain les « Remontées mécaniques de la Dent d'Ili » ou le nom abrégé « RDI » mais là, tout près de la fin, on découvre enfin le nouveau tarif !

____
[NOTE]
Grâce à la *livraison incrémentielle*, seuls les objets modifiés sont à transmettre à la suite d'un changement dans les données. 
____

Les deux fichiers ont alors été transmis à l'Association des offices de tourisme, comme convenu, laquelle a apparemment pu les lire sans la moindre difficulté. Objection de l'informaticien : cela n'a rien de bien surprenant aussi longtemps que nous saisissons les données attendues par l'Association et qui plus est avec un logiciel mis à notre disposition par ses soins. Mais nous, les Ilinois, nous en voulons plus ! Et nous voudrions si possible continuer à utiliser nos propres logiciels.

[#_2_3]
